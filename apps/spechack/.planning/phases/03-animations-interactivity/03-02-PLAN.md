---
phase: 03-animations-interactivity
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/app/[locale]/_components/AnimatedProgressBar.tsx
  - src/app/[locale]/_components/Judging.tsx
  - src/app/[locale]/_components/AccordionItem.tsx
  - src/app/[locale]/_components/FAQ.tsx
autonomous: true

must_haves:
  truths:
    - "Judging progress bars animate from 0% to target width when section enters viewport"
    - "FAQ accordion items expand and collapse with smooth CSS height transitions"
    - "FAQ chevron icons rotate 180deg on open and back on close"
    - "Multiple FAQ items can be open simultaneously"
  artifacts:
    - path: "src/app/[locale]/_components/AnimatedProgressBar.tsx"
      provides: "Client component for viewport-triggered progress bar width animation"
      exports: ["AnimatedProgressBar"]
    - path: "src/app/[locale]/_components/AccordionItem.tsx"
      provides: "Client component for accordion with smooth height transition"
      exports: ["AccordionItem"]
  key_links:
    - from: "src/app/[locale]/_components/Judging.tsx"
      to: "src/app/[locale]/_components/AnimatedProgressBar.tsx"
      via: "import and render per criterion"
      pattern: "AnimatedProgressBar"
    - from: "src/app/[locale]/_components/FAQ.tsx"
      to: "src/app/[locale]/_components/AccordionItem.tsx"
      via: "import and render per FAQ item"
      pattern: "AccordionItem"
---

<objective>
Add viewport-triggered progress bar animations for Judging criteria and smooth height transitions for FAQ accordion items.

Purpose: SC4 requires animated progress bars, SC5 requires smooth accordion transitions. This plan creates two client components (AnimatedProgressBar, AccordionItem) and integrates them into the existing server components.

Output: AnimatedProgressBar.tsx, AccordionItem.tsx, updated Judging.tsx and FAQ.tsx.
</objective>

<execution_context>
@/home/hybridz/.claude/get-shit-done/workflows/execute-plan.md
@/home/hybridz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-animations-interactivity/03-RESEARCH.md

Existing files to modify:
@src/app/[locale]/_components/Judging.tsx
@src/app/[locale]/_components/FAQ.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AnimatedProgressBar and update Judging</name>
  <files>src/app/[locale]/_components/AnimatedProgressBar.tsx, src/app/[locale]/_components/Judging.tsx</files>
  <action>
Create `src/app/[locale]/_components/AnimatedProgressBar.tsx`:

```tsx
"use client";

import { motion } from "framer-motion";

type AnimatedProgressBarProps = {
	label: string;
	pct: number;
	delay?: number;
};

export function AnimatedProgressBar({ label, pct, delay = 0 }: AnimatedProgressBarProps) {
	return (
		<div>
			<div className="flex justify-between items-center mb-1.5">
				<span className="font-mono text-xs text-muted-foreground">{label}</span>
				<span className="font-mono text-xs text-primary">{pct}%</span>
			</div>
			<div className="h-2 bg-muted rounded-full overflow-hidden">
				<motion.div
					initial={{ width: 0 }}
					whileInView={{ width: `${pct}%` }}
					viewport={{ once: true }}
					transition={{ delay: 0.3 + delay, duration: 0.8, ease: "easeOut" }}
					className="h-full bg-primary rounded-full"
				/>
			</div>
		</div>
	);
}
```

Then update `Judging.tsx`:
1. Add import: `import { AnimatedProgressBar } from "./AnimatedProgressBar";`
2. Replace the criteria bar rendering block (the `{criteria.map(({ labelKey, pct }) => (` ... `))}` section) with:

```tsx
{criteria.map(({ labelKey, pct }, i) => (
	<AnimatedProgressBar
		key={labelKey}
		label={t(labelKey)}
		pct={pct}
		delay={i * 0.1}
	/>
))}
```

Remove the old static progress bar markup. Judging stays as async server component.

Conventions: tabs, double quotes, named exports.
  </action>
  <verify>
Run `bun run build`. No errors. AnimatedProgressBar.tsx exists. Judging.tsx imports and uses AnimatedProgressBar. Run dev server and scroll to Judging — bars should animate from 0 to target width with staggered timing.
  </verify>
  <done>
AnimatedProgressBar client component created. Judging criteria bars animate from 0% to target with 100ms stagger between bars and 800ms fill duration.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create AccordionItem and update FAQ</name>
  <files>src/app/[locale]/_components/AccordionItem.tsx, src/app/[locale]/_components/FAQ.tsx</files>
  <action>
Create `src/app/[locale]/_components/AccordionItem.tsx`:

```tsx
"use client";

import { useState } from "react";

type AccordionItemProps = {
	question: string;
	answer: string;
};

export function AccordionItem({ question, answer }: AccordionItemProps) {
	const [open, setOpen] = useState(false);

	return (
		<div className="border border-border rounded-lg px-4 bg-card">
			<button
				type="button"
				onClick={() => setOpen(!open)}
				className="cursor-pointer py-4 w-full font-mono text-sm hover:text-foreground transition-colors flex justify-between items-center text-left"
				aria-expanded={open}
			>
				{question}
				<span
					className={`transition-transform duration-200 ${open ? "rotate-180" : ""}`}
				>
					▾
				</span>
			</button>
			<div
				className="grid transition-[grid-template-rows] duration-200 ease-out"
				style={{ gridTemplateRows: open ? "1fr" : "0fr" }}
			>
				<div className="overflow-hidden">
					<div className="pb-4 text-muted-foreground text-sm">{answer}</div>
				</div>
			</div>
		</div>
	);
}
```

Key design decisions:
- Uses CSS `grid-template-rows: 0fr → 1fr` for smooth height animation in BOTH directions (open and close)
- Inner `overflow-hidden` div clips content during transition
- `aria-expanded` for accessibility
- Chevron rotation via conditional className
- No Framer Motion dependency — pure CSS transition (lighter bundle)

Then update `FAQ.tsx`:
1. Add import: `import { AccordionItem } from "./AccordionItem";`
2. Replace ALL 4 `<details>` elements with AccordionItem components:

```tsx
<AccordionItem question={t("q0")} answer={t("a0")} />
<AccordionItem question={t("q1")} answer={t("a1")} />
<AccordionItem question={t("q2")} answer={t("a2")} />
<AccordionItem question={t("q3")} answer={t("a3")} />
```

3. Remove the `group` class references and all `<details>`, `<summary>` markup.
4. FAQ stays as async server component — AccordionItem is the client boundary.

Conventions: tabs, double quotes, named exports.
  </action>
  <verify>
Run `bun run build`. No errors. AccordionItem.tsx exists. FAQ.tsx imports and uses AccordionItem. Run dev server — click FAQ items to expand/collapse. Verify:
- Content expands smoothly (no instant jump)
- Content collapses smoothly (no instant disappear)
- Chevron rotates on open, rotates back on close
- Multiple items can be open at once
  </verify>
  <done>
AccordionItem client component created with CSS grid height transition. FAQ updated to use AccordionItem instead of native details/summary. Smooth expand/collapse in both directions with chevron rotation.
  </done>
</task>

</tasks>

<verification>
1. `bun run build` succeeds with no TypeScript errors
2. Judging progress bars animate from 0% to target width when section enters viewport
3. Progress bars stagger with 100ms offset between each (5 bars total)
4. FAQ accordion items expand with smooth height transition
5. FAQ accordion items collapse with smooth height transition (not instant)
6. FAQ chevron rotates 180deg on open, back to 0 on close
7. Multiple FAQ items can be open simultaneously
8. No hydration warnings in browser console
</verification>

<success_criteria>
- SC4: Judging criteria progress bars animate from 0% to target value when section enters viewport
- SC5: FAQ accordion items expand/collapse with smooth height transitions and rotate chevron icons
- Build passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/03-animations-interactivity/03-02-SUMMARY.md`
</output>
