---
phase: 03-animations-interactivity
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/app/[locale]/_components/StickyRegisterButton.tsx
  - src/app/[locale]/page.tsx
autonomous: true

must_haves:
  truths:
    - "Sticky register button appears when Hero section scrolls out of viewport"
    - "Sticky register button disappears when Hero section scrolls back into viewport"
    - "Clicking the sticky button scrolls to the Hero registration form"
    - "Button has smooth enter and exit animations"
  artifacts:
    - path: "src/app/[locale]/_components/StickyRegisterButton.tsx"
      provides: "Client component for floating register CTA with IntersectionObserver"
      exports: ["StickyRegisterButton"]
  key_links:
    - from: "src/app/[locale]/page.tsx"
      to: "src/app/[locale]/_components/StickyRegisterButton.tsx"
      via: "import and render after Footer"
      pattern: "StickyRegisterButton"
---

<objective>
Add a floating "Register" button that appears when the user scrolls past the Hero registration form.

Purpose: SC2 and SC3 require a sticky register button that appears on scroll and links back to the Hero form. This plan creates a StickyRegisterButton client component using IntersectionObserver + AnimatePresence and adds it to page.tsx.

Output: StickyRegisterButton.tsx client component, updated page.tsx.
</objective>

<execution_context>
@/home/hybridz/.claude/get-shit-done/workflows/execute-plan.md
@/home/hybridz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-animations-interactivity/03-RESEARCH.md

Existing files to modify:
@src/app/[locale]/page.tsx

Translation reuse:
The `navT("register")` is already fetched in page.tsx for the Navbar. Reuse it for the sticky button label — no new translation keys needed.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create StickyRegisterButton client component</name>
  <files>src/app/[locale]/_components/StickyRegisterButton.tsx</files>
  <action>
Create `src/app/[locale]/_components/StickyRegisterButton.tsx`:

```tsx
"use client";

import { useState, useEffect } from "react";
import { AnimatePresence, motion } from "framer-motion";

type StickyRegisterButtonProps = {
	label: string;
};

export function StickyRegisterButton({ label }: StickyRegisterButtonProps) {
	const [visible, setVisible] = useState(false);

	useEffect(() => {
		const hero = document.getElementById("register");
		if (!hero) return;

		const observer = new IntersectionObserver(
			([entry]) => setVisible(!entry.isIntersecting),
			{ threshold: 0.1 },
		);
		observer.observe(hero);
		return () => observer.disconnect();
	}, []);

	return (
		<AnimatePresence>
			{visible && (
				<motion.a
					href="#register"
					initial={{ opacity: 0, y: 20 }}
					animate={{ opacity: 1, y: 0 }}
					exit={{ opacity: 0, y: 20 }}
					transition={{ duration: 0.2 }}
					className="fixed bottom-6 right-6 z-40 bg-primary text-primary-foreground font-mono text-sm px-6 py-3 rounded-md shadow-lg hover:opacity-90 transition-opacity"
				>
					{label}
				</motion.a>
			)}
		</AnimatePresence>
	);
}
```

Key design:
- IntersectionObserver watches `#register` (Hero section id)
- `threshold: 0.1` — shows button when <10% of Hero is visible
- AnimatePresence enables smooth exit animation (fade down)
- Fixed bottom-right, z-40 (below navbar z-50)
- `shadow-lg` for depth against dark background
- Smooth scroll to `#register` provided by CSS `scroll-behavior: smooth` in globals.css
- No new translations needed — uses existing `navbar.register` passed as prop

Conventions: tabs, double quotes, named exports.
  </action>
  <verify>
Run `bun run build`. No errors. StickyRegisterButton.tsx exists and exports StickyRegisterButton.
  </verify>
  <done>
StickyRegisterButton client component created with IntersectionObserver visibility detection and AnimatePresence enter/exit animations.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add StickyRegisterButton to page.tsx</name>
  <files>src/app/[locale]/page.tsx</files>
  <action>
Update `page.tsx`:

1. Add import: `import { StickyRegisterButton } from "./_components/StickyRegisterButton";`

2. Add after the `<Footer />` closing tag (inside the fragment, after `</FadeInSection>` wrapping Footer):

```tsx
<StickyRegisterButton label={navT("register")} />
```

This reuses the `navT` translations object already fetched at the top of HomePage for the Navbar. No additional `getTranslations` call needed.

Conventions: tabs, double quotes.
  </action>
  <verify>
Run `bun run build`. No errors. Run `bun run dev` and test:
1. On page load — sticky button is NOT visible (Hero is in viewport)
2. Scroll past Hero — sticky button fades in at bottom-right
3. Click sticky button — page scrolls smoothly to Hero registration form
4. Scroll back to Hero — sticky button fades out
5. Check mobile viewport — button doesn't overlap critical content
  </verify>
  <done>
StickyRegisterButton added to page composition. Button appears when scrolled past Hero, disappears when Hero returns to view, and scrolls smoothly to registration form on click.
  </done>
</task>

</tasks>

<verification>
1. `bun run build` succeeds with no TypeScript errors
2. Sticky button is hidden on initial page load (Hero visible)
3. Sticky button appears with fade-up animation when scrolled past Hero
4. Sticky button disappears with fade-down animation when scrolled back to Hero
5. Clicking sticky button scrolls smoothly to #register section
6. Button is positioned fixed bottom-right with z-40
7. Button doesn't overlap navbar (z-40 < z-50)
8. No hydration warnings in browser console
</verification>

<success_criteria>
- SC2: User scrolling past Hero sees sticky "Register" button at bottom of viewport
- SC3: Clicking sticky button scrolls smoothly back to Hero registration form
- Build passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/03-animations-interactivity/03-03-SUMMARY.md`
</output>
